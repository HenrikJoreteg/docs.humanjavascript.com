<!DOCTYPE html>
<html>
  <head>
    <link type="text/css" rel="stylesheet" href="/static/css/main.css">
    <link type="text/css" rel="stylesheet" href="/static/css/&amp;yet-highlight.css">
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-44685415-1', 'humanjavascript.com');
      ga('send', 'pageview');
    </script>
    <title>Human JavaScript: ch09 - clientside routing</title>
  </head>
  <body>
    <nav>
      <h3>Chapters</h3>
      <ul id="chapters"><a href="ch00-foreword.html" class="h2">ch00 - foreword</a><a href="ch01-introduction.html" class="h2">ch01 - introduction</a><a href="ch02-the-big-decision.html" class="h2">ch02 - the big decision</a><a href="ch03-code-for-humans.html" class="h2">ch03 - code for humans</a><a href="ch04-organizing-your-code.html" class="h2">ch04 - organizing your code</a><a href="ch05-eventification.html" class="h2">ch05 - eventification</a><a href="ch06-models.html" class="h2">ch06 - models</a><a href="ch07-views.html" class="h2">ch07 - views</a><a href="ch08-templating.html" class="h2">ch08 - templating</a><a href="ch09-clientside-routing.html" class="h2">ch09 - clientside routing</a><a href="ch10-launch-sequence.html" class="h2">ch10 - launch sequence</a><a href="ch11-testing-and-qa-that-doesnt-suck.html" class="h2">ch11 - testing and QA that doesnt suck</a><a href="ch12-settings-and-configs.html" class="h2">ch12 - settings and configs</a><a href="ch13-caveats.html" class="h2">ch13 - caveats</a><a href="ch14-conclusion.html" class="h2">ch14 - conclusion</a>
      </ul>
      <div id="slider"></div>
    </nav>
    <main>
      <h1 class="humanjs">HumanJS</h1><h1>Clientside routing (if there is such a thing)</h1>
<p>One thing you sometimes lose with a browser app is the proper handling of the browser&apos;s &quot;back&quot; button and the ability to &quot;deep link&quot; into some specific view of the app.

</p>
<p>The good news is we don&apos;t actually have to make those tradeoffs. Through the clever use of Backbone&apos;s router and HTML5 push state, browser apps can take over the world. Here&apos;s how it works...



</p>
<h2>Same sh*t different URL</h2>
<p>From the server perspective, how do we actually &quot;hand control of routing to the client&quot;? Ugh... that&apos;s not how the web works, right? The server has to answer actual http GET request when a user types your app&apos;s URL in their browser.

</p>
<p>So what I mean is simply that you return the same app HTML at multiple URLs.

</p>
<p>For example, it doesn&apos;t matter if you hit:

</p>
<p><a href="https://andbang.com/andyet/chat">https://andbang.com/andyet/chat</a>

</p>
<p>or 

</p>
<p><a href="https://andbang.com/basecamp">https://andbang.com/basecamp</a>

</p>
<p>Either way, the server will return this HTML:

</p>
<pre><code class="html">&lt;!DOCTYPE html&gt;
&lt;script src=&quot;/&amp;!.js&quot;&gt;&lt;/script&gt;</code></pre>
<p>It may be helpful to think about it as a block of URLs that all just serve the app.

</p>
<p>If you&apos;re using Express and Node it&apos;s quite easy to do.

</p>
<pre><code class="javascript">app.get(&apos;/other/thing&apos;, function () {
  // You could still serve other support pages 
  // and simple things at specific URLs.
});

// But then you want some sort of catch all that matches
// the range of URLs you&apos;re going to want the single page app
// to be available at:
app.get(&apos;*&apos;, function (req, res) {
  res.sendFile(&apos;sameShit.html&apos;);
});</code></pre>
<p>At this point finding/fetching the right data and rendering the right view is up to the browser app.


</p>
<h2>How to deal with clientside routes</h2>
<p>And Bang has a task detail page for every task at a URL structure that looks like this:

</p>
<p><a href="https://andbang.com/andyet/tasks/47">https://andbang.com/andyet/tasks/47</a>

</p>
<p>So, if a user types that URL in their browser the user will see a detail view of that task. Also, if they&apos;re somewhere else in the app and navigate to that task view by clicking the task in their list, the page won&apos;t reload, but when you look at the URL bar in the browser, that&apos;s the page you&apos;re on.

</p>
<p>Backbone&apos;s router is really handy for handling all of that stuff. 

</p>
<p>But, in order to grasp how this works in practice, we have to talk a bit about the application launch sequence. 
</p>

    </main>
    <footer><span class="prev"><a href="/book/ch08-templating.html">ch08 - templating</a></span><span class="next"><a href="/book/ch10-launch-sequence.html">ch10 - launch sequence</a></span>
    </footer>
  </body>
  <script src="/static/js/highlight.pack.js"></script>
  <script src="/static/js/slugger.js"></script>
  <script src="/static/js/setup.js"></script>
  <script src="http://static.andyet.com/tag.js"></script>
</html>